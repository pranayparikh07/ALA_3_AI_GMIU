<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NovaChat ‚Äì AI Assistant</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Tailwind Typography for better text formatting -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.5.9/dist/typography.min.css">
  <!-- Highlight.js for syntax highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body class="bg-gray-950 text-white h-screen flex font-sans">

  <!-- Sidebar -->
  <aside class="w-64 bg-gray-900 border-r border-gray-800 flex flex-col">
    <div class="p-4 border-b border-gray-800">
      <h1 class="text-xl font-bold text-cyan-400">NovaChat</h1>
      <p class="text-sm text-gray-400">AI Assistant</p>
    </div>

    <nav class="flex-1 overflow-y-auto p-4 space-y-2 text-sm">
      <p class="text-gray-400 uppercase text-xs mb-2">Quick Prompts</p>
      <button onclick="usePrompt('Summarize an article')"
              class="w-full text-left px-3 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition">
        Summarize an article
      </button>
      <button onclick="usePrompt('Generate 5 creative startup ideas')"
              class="w-full text-left px-3 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition">
        Startup ideas
      </button>
      <button onclick="usePrompt('Explain recursion simply')"
              class="w-full text-left px-3 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition">
        Explain recursion
      </button>
      <button onclick="usePrompt('Latest cybersecurity threats')"
              class="w-full text-left px-3 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition">
        Cybersecurity trends
      </button>
      <button onclick="usePrompt('Write a Python factorial function')"
              class="w-full text-left px-3 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition">
        Python factorial code
      </button>
    </nav>

    <div class="p-4 border-t border-gray-800 text-xs text-gray-500">
      ¬© 2025 NovaChat Inc.
    </div>
  </aside>

  <!-- Main Chat Area -->
  <main class="flex-1 flex flex-col">
    <!-- Header -->
    <header class="p-4 border-b border-gray-800 flex items-center justify-between">
      <h2 class="text-lg font-semibold text-white">Chat</h2>
      <span class="text-xs text-gray-400">Professional SaaS Mode</span>
    </header>

    <!-- Chatbox -->
    <div id="chatbox" class="flex-1 overflow-y-auto p-6 space-y-4 bg-gray-950 prose prose-invert">
      <div class="text-center text-gray-500 text-sm">Start a conversation with NovaChat üöÄ</div>
    </div>

    <!-- Input area -->
    <div class="border-t border-gray-800 p-4">
      <div class="flex items-center bg-gray-900 border border-gray-700 rounded-lg overflow-hidden">
        <input id="userInput" 
               type="text" 
               placeholder="Ask NovaChat anything..." 
               class="flex-1 bg-transparent text-white px-4 py-3 focus:outline-none placeholder-gray-500">
        <button onclick="sendMessage()" 
                class="bg-cyan-500 hover:bg-cyan-600 text-black font-bold px-5 py-3 transition">
          ‚û§
        </button>
      </div>
      <p class="mt-2 text-xs text-gray-500 text-center">
        NovaChat may display AI-generated content. Use wisely.
      </p>
    </div>
  </main>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    const input = document.getElementById("userInput");
    const chatbox = document.getElementById("chatbox");

    // Rotating placeholder prompts
    const placeholderPrompts = [
      "Summarize an article",
      "Generate 5 startup ideas",
      "Explain recursion like I‚Äôm 10",
      "Latest cybersecurity threats",
      "Show Python factorial code"
    ];
    let placeholderIndex = 0;
    setInterval(() => {
      input.placeholder = placeholderPrompts[placeholderIndex];
      placeholderIndex = (placeholderIndex + 1) % placeholderPrompts.length;
    }, 4000);

    // Enter-to-send
    input.addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        sendMessage();
      }
    });

    function usePrompt(text) {
      input.value = text;
      sendMessage();
    }

    async function sendMessage() {
      const message = input.value.trim();
      if (!message) return;

      // User bubble
      chatbox.innerHTML += `
        <div class="flex justify-end">
          <div class="bg-cyan-500 text-black px-4 py-2 rounded-lg max-w-xl shadow whitespace-pre-wrap">
            ${message}
          </div>
        </div>`;
      chatbox.scrollTop = chatbox.scrollHeight;
      input.value = "";

      // Bot placeholder
      const botBubble = document.createElement("div");
      botBubble.className = "flex justify-start";
      const span = document.createElement("div");
      span.className = "bg-gray-800 text-gray-200 px-4 py-2 rounded-lg max-w-xl shadow prose prose-invert text-sm";
      botBubble.appendChild(span);
      chatbox.appendChild(botBubble);

      try {
        const response = await fetch("/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message })
        });
        const data = await response.json();

        // Render Markdown
        span.innerHTML = marked.parse(data.reply);

        // Highlight code if present
        span.querySelectorAll("pre code").forEach((block) => {
          hljs.highlightElement(block);
        });

        chatbox.scrollTop = chatbox.scrollHeight;
      } catch (error) {
        span.innerHTML = "‚ö†Ô∏è Error fetching response.";
      }
    }
  </script>
</body>
</html>
